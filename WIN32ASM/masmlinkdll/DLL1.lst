Microsoft (R) Macro Assembler Version 6.14.8444		    12/01/03 01:26:23
E:\programs\WIN32ASM\MASMLI~1\DLL1.asm			     Page 1 - 1


				;32BIT DLL
				.386
				.model	flat,stdcall
				.nolist
				;include macro.inc
				.listall
				includelib user32.lib
				includelib kernel32.lib
 00000000			.data
 00000000 74 68 69 73 20	a1	db	"this is the sample message",0
	   69 73 20 74 68
	   65 20 73 61 6D
	   70 6C 65 20 6D
	   65 73 73 61 67
	   65 00
 00000000			.data?

 00000000			.code
 00000000			DllEntry proc hinst:HINSTANCE,reason:dword,reserved1:dword
 00000000  55		   *	    push   ebp
 00000001  8B EC	   *	    mov    ebp, esp
 00000003  B8 00000001			mov	eax,TRUE
					.if 	reason==DLL_PROCESS_ATTACH
 00000008  83 7D 0C 01	   *	    cmp    reason, DLL_PROCESS_ATTACH
 0000000C  75 02	   *	    jne    @C0001

					.elseif reason==DLL_PROCESS_DETACH
 0000000E  EB 10	   *	    jmp    @C0003
 00000010		   *@C0001:
 00000010  83 7D 0C 00	   *	    cmp    reason, DLL_PROCESS_DETACH
 00000014  75 02	   *	    jne    @C0004

					.elseif reason==DLL_THREAD_ATTACH
 00000016  EB 08	   *	    jmp    @C0006
 00000018		   *@C0004:
 00000018  83 7D 0C 02	   *	    cmp    reason, DLL_THREAD_ATTACH
 0000001C  75 02	   *	    jne    @C0007

					.else        ; DLL_THREAD_DETACH
 0000001E  EB 00	   *	    jmp    @C0009
 00000020		   *@C0007:

					.endif
 00000020		   *@C0009:
 00000020		   *@C0006:
 00000020		   *@C0003:
					ret
 00000020  C9		   *	    leave  
 00000021  C2 000C	   *	    ret    0000Ch
 00000024			DllEntry endp


 00000024			madhurahuja	proc

					invoke	MessageBox,0,offset a1,offset a1,0
 00000024  6A 00	   *	    push   +000000000h
 00000026  68 00000000 R   *	    push   dword  ptr OFFSET FLAT:a1
 0000002B  68 00000000 R   *	    push   dword  ptr OFFSET FLAT:a1
 00000030  6A 00	   *	    push   +000000000h
 00000032  E8 00000000 E   *	    call   MessageBoxA
 00000037  C3				ret
 00000038			madhurahuja	endp
				end	DllEntry
